---
title: "BST 210 PROJECT"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r, warning = FALSE, message = FALSE}

library(tidyverse)
library(dplyr)

hiv <- read.csv(file ="data/hivstat.csv", header = TRUE, sep = ",")

baseline <- read.csv(file ="data/f00.csv", header = TRUE, sep = ",")

sociodemographic <-read.csv(file ="data/f01.csv", header = TRUE, sep =",")

physical <- read.csv(file = "data/height_and_weight.csv", header = TRUE, sep = ",")
colnames(physical)[2] <- "CASEID"

medhistory <- read.csv(file = "data/hx_cleaned.csv", header = TRUE, sep = ",")

outcome <- read.csv(file = "data/outcome_cleaned.csv", header = TRUE, sep = ",")

join1 <- inner_join(hiv, baseline, by = "CASEID" )
join2 <- inner_join(join1, sociodemographic, by ="CASEID")
join3 <- inner_join(join2, medhistory, by = "CASEID")
join4 <- inner_join(join3, outcome, by = "CASEID")
all <- inner_join(join4 , physical, by = "CASEID")

all <- all[, c("CASEID", "STATUS", "SPANSC", "AGE_SC", "RACESC", "EDUCSC", "MOMESC", "IDU_SC", "PARTSC", "COB_SD", "MAR_SD","INC_SD","FMCNHX", "FMHBHX", "FMCLHX", "MAGEHX", "EHRTHX", "OUTCAIDS", "OUTCCANC", "OUTCTB", "OUTCDTH", "height_cm", "weight_kg")]

CASEID <- all$CASEID
hivstat <- all$STATUS
speak_spanish <- all$SPANSC
age <- all$AGE_SC
ethnicity <- all$RACESC
educ_level <- all$EDUCSC
mother_educ <- all$MOMESC
drug <- all$IDU_SC
sex_partners <- all$PARTSC
birth_country <- all$COB_SD
marital_status <- all$MAR_SD
household_income <- all$INC_SD
family_cancer <- all$FMCNHX
family_hbp <- all$FMHBHX
family_cholesterol <- all$FMCLHX
first_menstruation <- all$MAGEHX
ever_hrt <- all$EHRTHX
aids <- all$OUTCAIDS
cancer <- all$OUTCCANC
tb <- all$OUTCTB
death <- all$OUTCDTH
height <- all$height_cm
weight <- all$weight_kg

colnames(all) <- c("CASEID", "hivstat", "speak_spanish", "age", "ethnicity", "educ_level", "mother_educ", "drug", "sex_partners", "birth_country", "marital_status", "household_income", "family_cancer", "family_hbp", "family_cholesterol", "first_menstruation", "ever_hrt", "aids", "cancer", "tb", "death", "height", "weight")

all$bmi <- all$weight/(all$height/100)^2 
bmi <- all$bmi
```

```{r}
library(ggplot2)
all %>% ggplot()+
  geom_boxplot(aes(factor(hivstat), age))+
  labs(x = "HIV Status", y = "Age")
```


```{r}

all %>% ggplot(aes(x = factor(hivstat), y = household_income)) +
  geom_boxplot()+
  labs(x = "HIV Status", y = "Household income")

```

```{r}

aids_proportion <- with(all, table(aids, hivstat)) %>% prop.table(margin = 2)
aids_proportion
```

```{r}

educ_proportion <- with(all, table(educ_level, hivstat)) %>% prop.table(margin  = 2)
educ_proportion
```

```{r}
partners_prop <- with(all, table(sex_partners, hivstat)) %>% prop.table(margin = 1)
partners_prop
```
```{r}
library(ggplot2)
all %>% ggplot()+
  geom_boxplot(aes(factor(hivstat), bmi))+
  labs(x = "HIV Status", y = "BMI")

```

```{r}

ethnicity_prop <- with(all, table(ethnicity, hivstat)) %>% prop.table(margin = 2)
ethnicity_prop

```
```{r}
maritalstatus_prop <- with(all, table(marital_status, hivstat)) %>% prop.table(margin = 2)
maritalstatus_prop

```